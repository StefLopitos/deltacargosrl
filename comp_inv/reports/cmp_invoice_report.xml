<?xml version="1.0" encoding="utf-8" ?>
<odoo>

    <template id="fb_css_assets" name="fbinv assets" inherit_id="web.report_assets_common">
        <xpath expr="//t[@t-name='web.report_assets_common']" position="inside">
            <link href="/comp_inv/static/src/css/report_style.css" rel="stylesheet"/>
        </xpath>
    </template>

    <template id="comp_inv.cmp_invoice_report_doc">

        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="o">
                <t t-call="web.basic_layout">
                    <div class="page">
                        <div class="row col-12">
                            <div class="col-4 pt-2 text-center">
                                <img t-if="o.dosage_id.company_logo"
                                     t-att-src="'data:image/png;base64,%s' % to_text(o.dosage_id.company_logo)"
                                     style="height: 125px;" alt="o.dosage_id.business_name"/>
                                <div class="box-company">
                                    <span t-field="o.dosage_id.business_name"/>
                                </div>
                                <div class="box-small-description">
                                    <span t-field="o.dosage_id.invoice_header"/>
                                </div>
                            </div>
                            <div class="col-4 pt-2">
                                <div class="box-title text-center">FACTURA</div>
                            </div>
                            <div class="col-4 pt-5">
                                <div class="box-round">
                                    <p class="box-nit">
                                        NIT:
                                        <span t-field="o.dosage_id.tin"/>
                                    </p>
                                    <p class="box-nit">
                                        FACTURA:
                                        <span t-field="o.invoice_number"/>
                                    </p>
                                    <p class="box-nit">
                                        NÂº AUTORIZACION:
                                        <span t-field="o.dosage_id.auth_number"/>
                                    </p>
                                </div>
                                <p class="text-center" t-field="o.dosage_id.activity_id.name"></p>
                            </div>
                        </div>
                        <div class="row col-12 pt-5 font-mid">
                            <div class="col-4">
                                <span t-field="o.dosage_id.location"/>
                                <span class="box-date">
                                    <t t-esc="o.date_emission.strftime('%d / %m / %Y')"/>
                                </span>
                            </div>
                            <div class="col-4">
                                C.I. / N.I.T.:
                                <span class="box-nit-ci">
                                    <span t-field="o.customer_tin"/>
                                </span>
                            </div>
                            <div class="col-4">

                            </div>
                        </div>
                        <div class="row col-12 pt-3">
                            <div class="col-12 table-round">
                                <table class="invoice-detail-letter">
                                    <th>CONCEPTO</th>
                                    <th>CANT</th>
                                    <th>PRECIO</th>
                                    <th>SUBTOTAL</th>
                                    <tr t-foreach="o.invoice_lines" t-as="line">
                                        <td>
                                            <span t-field="line.name"/>
                                        </td>
                                        <td class="bleft">
                                            <span t-field="line.product_qty"/>
                                        </td>
                                        <td class="bleft text-right">
                                            <span t-field="line.price_unit"/>
                                        </td>
                                        <td class="bleft text-right">
                                            <span t-field="line.price_subtotal"/>
                                        </td>
                                    </tr>
                                    <tr class="bottom-fill-row">
                                        <td class="bottom-fill-cell"></td>
                                        <td class="bottom-fill-cell bleft"></td>
                                        <td class="bottom-fill-cell bleft"></td>
                                        <td class="bottom-fill-cell bleft"></td>
                                    </tr>
                                    <tr>
                                        <td class="bottom-cell"></td>
                                        <td class="bottom-cell"></td>
                                        <td class="bottom-cell text-right">TOTAL Bs.:</td>
                                        <td class="bottom-cell text-right">
                                            <span t-field="o.amount_total"></span>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-10">
                                <div class="col-12">
                                    <p class="pt-2">
                                        <strong>CODIGO DE CONTROL:</strong>
                                        <strong>
                                            <span t-field="o.control_code"/>
                                        </strong>
                                    </p>
                                    <p>
                                        <strong>Fecha Limite de Emision:</strong>
                                        <strong>
                                            <span t-field="o.dosage_id.date_due"/>
                                        </strong>
                                    </p>
                                    <p class="ad_footer text-center" t-field="o.dosage_id.invoice_footer"/>
                                </div>
                            </div>
                            <div class="col-2" style="margin-left:-23pt; margin-top:4pt">
                                <img style="width:100%" class="border border-dark rounded" t-att-src="o.get_qr_url()"
                                     alt="QR CODE"/>
                            </div>
                        </div>
                    </div>
                </t>
            </t>
        </t>
    </template>


    <report
            id="cmp_invoice_report"
            string="Comp. Invoice"
            model="cmp.invoice"
            report_type="qweb-pdf"
            name="comp_inv.cmp_invoice_report_doc"
            file="cmp_inv"
    />
</odoo>